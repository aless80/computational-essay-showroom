<!DOCTYPE html>
<html lang="en">
  

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,minimum-scale=1">

  <title>What are the effects of relativity on particles in the LHC?</title>
  <meta name="description" content="Simulating CERNs Particle Accelerator">

  <link rel="canonical" href="http://0.0.0.0:4000/computational-essay-showroom/essays/studentessays/LHC/LHC_CompEssay.html">
  <link rel="alternate" type="application/rss+xml" title="Computational essays from the University of Oslo" href="http://0.0.0.0:4000/computational-essay-showroom/feed.xml">

  <meta property="og:url"         content="http://0.0.0.0:4000/computational-essay-showroom/essays/studentessays/LHC/LHC_CompEssay.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="What are the effects of relativity on particles in the LHC?" />
<meta property="og:description" content="Simulating CERNs Particle Accelerator" />
<meta property="og:image"       content="" />


  <script type="application/ld+json">
  {
  "@context": "http://schema.org",
  "@type": "NewsArticle",
  "mainEntityOfPage":
    "http://0.0.0.0:4000/computational-essay-showroom/essays/studentessays/LHC/LHC_CompEssay.html",
  "headline":
    "What are the effects of relativity on particles in the LHC?",
  "datePublished":
    "2019-04-05T03:53:29-05:00",
  "dateModified":
    "2019-04-05T03:53:29-05:00",
  "description":
    "Simulating CERNs Particle Accelerator",
  "author": {
    "@type": "Person",
    "name": "UiO"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Data 100 at UC Berkeley",
    "logo": {
      "@type": "ImageObject",
      "url": "http://0.0.0.0:4000/computational-essay-showroom",
      "width": 60,
      "height": 60
    }
  },
  "image": {
    "@type": "ImageObject",
    "url": "http://0.0.0.0:4000/computational-essay-showroom",
    "height": 60,
    "width": 60
  }
}

  </script>
  <link rel="stylesheet" href="/computational-essay-showroom/assets/css/styles.css">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css ">
  <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png">

  <!-- <link rel="manifest" href="/manifest.json"> -->
  <!-- <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#efae0a"> -->
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="msapplication-TileImage" content="/mstile-144x144.png">
  <meta name="theme-color" content="#233947">

  <!-- Favicon -->
  <link rel="shortcut icon" type="image/x-icon" href="/computational-essay-showroom/images/logo/favicon.ico">

  <!-- MathJax Config -->
  <!-- Allow inline math using $ and automatically break long math lines -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true,
        processEnvironments: true
    },
    CommonHTML: {
        linebreaks: {
            automatic: true,
        },
    },
});
</script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_CHTML' async></script>

  <!-- DOM updating function -->
  <script>
const runWhenDOMLoaded = cb => {
  if (document.readyState != 'loading') {
    cb()
  } else if (document.addEventListener) {
    document.addEventListener('DOMContentLoaded', cb)
  } else {
    document.attachEvent('onreadystatechange', function() {
      if (document.readyState == 'complete') cb()
    })
  }
}

// Helper function to init things quickly
initFunction = function(myfunc) {
  runWhenDOMLoaded(myfunc);
  document.addEventListener('turbolinks:load', myfunc);
};
</script>

  <!-- Define some javascript variables that will be useful in other javascript -->
  <script>
    const site_basename = '/computational-essay-showroom';
  </script>

  <!-- Add AnchorJS to let headers be linked -->
  <script src="/computational-essay-showroom/assets/js/anchor.min.js"  type="text/javascript"></script>
  <script>

initFunction(function () {
    anchors.add("main h1, main h2, main h3, main h4")
});

</script>

  <!-- Include Turbolinks to make page loads fast -->
  <!-- https://github.com/turbolinks/turbolinks -->
  <script src="/computational-essay-showroom/assets/js/turbolinks.js" async></script>
  <meta name="turbolinks-cache-control" content="no-cache">

  <!-- Load nbinteract for widgets -->
  <script src="https://unpkg.com/nbinteract-core" async></script>

  <!-- Load Thebelab for interactive widgets -->
  <!-- Include Thebelab for interactive code if it's enabled -->


  <!-- Google analytics -->
  <script src="/computational-essay-showroom/assets/js/ga.js" async></script>

  <!-- Clipboard copy button -->
  <script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js" async></script>

  <!-- Load JS that depends on site variables -->
  <script>
/**
 * Set up copy/paste for code blocks
 */
const codeCellId = index => `codecell${index}`

const clipboardButton = id =>
  `<a class="btn copybtn o-tooltip--left" data-tooltip="Copy" data-clipboard-target="#${id}">
    <img src="/computational-essay-showroom/assets/images/copy-button.svg" alt="Copy to clipboard">
  </a>`

// Clears selected text since ClipboardJS will select the text when copying
const clearSelection = () => {
  if (window.getSelection) {
    window.getSelection().removeAllRanges()
  } else if (document.selection) {
    document.selection.empty()
  }
}

// Changes tooltip text for two seconds, then changes it back
const temporarilyChangeTooltip = (el, newText) => {
  const oldText = el.getAttribute('data-tooltip')
  el.setAttribute('data-tooltip', newText)
  setTimeout(() => el.setAttribute('data-tooltip', oldText), 2000)
}

const addCopyButtonToCodeCells = () => {
  // If ClipboardJS hasn't loaded, wait a bit and try again. This
  // happens because we load ClipboardJS asynchronously.
  if (window.ClipboardJS === undefined) {
    setTimeout(addCopyButtonToCodeCells, 250)
    return
  }

  const codeCells = document.querySelectorAll('div.highlighter-rouge:not(.output) pre')
  codeCells.forEach((codeCell, index) => {
    const id = codeCellId(index)
    codeCell.setAttribute('id', id)
    if (document.querySelector(`pre#${id} + a`) == null) {
      codeCell.insertAdjacentHTML('afterend', clipboardButton(id));
    }
  })

  const clipboard = new ClipboardJS('.copybtn')
  clipboard.on('success', event => {
    clearSelection()
    temporarilyChangeTooltip(event.trigger, 'Copied!')
  })

  clipboard.on('error', event => {
    temporarilyChangeTooltip(event.trigger, 'Failed to copy')
  })

  // Get rid of clipboard before the next page visit to avoid memory leak
  document.addEventListener('turbolinks:before-visit', () =>
    clipboard.destroy()
  )
}

initFunction(addCopyButtonToCodeCells);
</script>

  <!-- Hide cell code -->
  
<script>
/**
Add buttons to hide code cells
*/


var setCodeCellVisibility = function(inputField, kind) {
    // Update the image and class for hidden
    var id = inputField.getAttribute('data-id');
    var codeCell = document.querySelector(`#${id}`);

    if (kind === "visible") {
        codeCell.classList.remove('hidden');
        inputField.checked = true;
    } else {
        codeCell.classList.add('hidden');
        inputField.checked = false;
    }
}

var toggleCodeCellVisibility = function (event) {
    // The label is clicked, and now we decide what to do based on the input field's clicked status
    if (event.target.tagName === "LABEL") {
        var inputField = event.target.previousElementSibling;
    } else {
        // It is the span inside the target
        var inputField = event.target.parentElement.previousElementSibling;
    }

    if (inputField.checked === true) {
        setCodeCellVisibility(inputField, "visible");
    } else {
        setCodeCellVisibility(inputField, "hidden");
    }
}


// Button constructor
const hideCodeButton = id => `<input class="hidebtn" type="checkbox" id="hidebtn${id}" data-id="${id}"><label title="Toggle cell" for="hidebtn${id}" class="plusminus"><span class="pm_h"></span><span class="pm_v"></span></label>`

var addHideButton = function () {
  // If a hide button is already added, don't add another
  if (document.querySelector('div.hidecode input') !== null) {
      return;
  }

  // Find the input cells and add a hide button
  document.querySelectorAll('div.input_area div.highlight').forEach(function (item, index) {
    if (!item.parentElement.classList.contains("hidecode")) {
        // Skip the cell if it doesn't have a hidecode class
        return;
    }

    const id = codeCellId(index)
    item.setAttribute('id', id);
    item.insertAdjacentHTML('afterend', hideCodeButton(id))

    // Set up the visibility toggle
    hideLink = document.querySelector(`#${id} + input + label`);
    hideLink.addEventListener('click', toggleCodeCellVisibility)
  });
}


// Initialize the hide buttos
var initHiddenCells = function () {
    // Add hide buttons to the cells
    addHideButton();

    // Toggle the code cells that should be hidden
    document.querySelectorAll('div.hidecode input').forEach(function (item) {
        setCodeCellVisibility(item, 'hidden');
        item.checked = true;
    })
}

initFunction(initHiddenCells);

</script>


  <!-- Load custom website scripts -->
  <script src="/computational-essay-showroom/assets/js/scripts.js" async></script>

  <!-- Load custom user CSS and JS  -->
  <script src="/computational-essay-showroom/assets/custom/custom.js" async></script>
  <link rel="stylesheet" href="/computational-essay-showroom/assets/custom/custom.css">

  <!-- Update interact links w/ REST param, is defined in includes so we can use templates -->
  
<script>
/**
  * To auto-embed hub URLs in interact links if given in a RESTful fashion
 */

function getJsonFromUrl(url) {
  var query = url.split('?');
  if (query.length < 2) {
    // No queries so just return false
    return false;
  }
  query = query[1];
  // Collect REST params into a dictionary
  var result = {};
  query.split("&").forEach(function(part) {
    var item = part.split("=");
    result[item[0]] = decodeURIComponent(item[1]);
  });
  return result;
}
    
function dict2param(dict) {
    params = Object.keys(dict).map(function(k) {
        return encodeURIComponent(k) + '=' + encodeURIComponent(dict[k])
    });
    return params.join('&')
}

// Parse a Binder URL, converting it to the string needed for JupyterHub
function binder2Jupyterhub(url) {
  newUrl = {};
  parts = url.split('v2/gh/')[1];
  // Grab the base repo information
  repoinfo = parts.split('?')[0];
  var [org, repo, ref] = repoinfo.split('/');
  newUrl['repo'] = ['https://github.com', org, repo].join('/');
  newUrl['branch'] = ref
  // Grab extra parameters passed
  params = getJsonFromUrl(url);
  if (params['filepath'] !== undefined) {
    newUrl['subPath'] = params['filepath']
  }
  return dict2param(newUrl);
}

// Filter out potentially unsafe characters to prevent xss
function safeUrl(url)
{
   return String(encodeURIComponent(url))
            .replace(/&/g, '&amp;')
            .replace(/"/g, '&quot;')
            .replace(/'/g, '&#39;')
            .replace(/</g, '&lt;')
            .replace(/>/g, '&gt;');
}

function addParamToInternalLinks(hub) {
  var links = document.querySelectorAll("a").forEach(function(link) {
    var href = link.href;
    // If the link is an internal link...
    if (href.search("http://0.0.0.0:4000") !== -1 || href.startsWith('/') || href.search("127.0.0.1:") !== -1) {
      // Assume we're an internal link, add the hub param to it
      var params = getJsonFromUrl(href);
      if (params !== false) {
        // We have REST params, so append a new one
        params['jupyterhub'] = hub;
      } else {
        // Create the REST params
        params = {'jupyterhub': hub};
      }
      // Update the link
      var newHref = href.split('?')[0] + '?' + dict2param(params);
      link.setAttribute('href', decodeURIComponent(newHref));
    }
  });
  return false;
}


// Update interact links
function updateInteractLink() {
    // hack to make this work since it expects a ? in the URL
    rest = getJsonFromUrl("?" + location.search.substr(1));
    jupyterHubUrl = rest['jupyterhub'];
    var hubType = null;
    var hubUrl = null;
    if (jupyterHubUrl !== undefined) {
      hubType = 'jupyterhub';
      hubUrl = jupyterHubUrl;
    }

    if (hubType !== null) {
      // Sanitize the hubUrl
      hubUrl = safeUrl(hubUrl);

      // Add HTTP text if omitted
      if (hubUrl.indexOf('http') < 0) {hubUrl = 'http://' + hubUrl;}
      var interactButtons = document.querySelectorAll("button.interact-button")
      var lastButton = interactButtons[interactButtons.length-1];
      var link = lastButton.parentElement;

      // If we've already run this, skip the link updating
      if (link.nextElementSibling !== null) {
        return;
      }

      // Update the link and add context div
      var href = link.getAttribute('href');
      if (lastButton.id === 'interact-button-binder') {
        // If binder links exist, we need to re-work them for jupyterhub
        if (hubUrl.indexOf('http%3A%2F%2Flocalhost') > -1) {
          // If localhost, assume we're working from a local Jupyter server and remove `/hub`
          first = [hubUrl, 'git-sync'].join('/')
        } else {
          first = [hubUrl, 'hub', 'user-redirect', 'git-sync'].join('/')
        }
        href = first + '?' + binder2Jupyterhub(href);
      } else {
        // If interact button isn't binderhub, assume it's jupyterhub
        // If JupyterHub links, we only need to replace the hub url
        href = href.replace("", hubUrl);
        if (hubUrl.indexOf('http%3A%2F%2Flocalhost') > -1) {
          // Assume we're working from a local Jupyter server and remove `/hub`
          href = href.replace("/hub/user-redirect", "");
        }
      }
      link.setAttribute('href', decodeURIComponent(href));

      // Add text after interact link saying where we're launching
      hubUrlNoHttp = decodeURIComponent(hubUrl).replace('http://', '').replace('https://', '');
      link.insertAdjacentHTML('afterend', '<div class="interact-context">on ' + hubUrlNoHttp + '</div>');

      // Update internal links so we retain the hub url
      addParamToInternalLinks(hubUrl);
    }
}

runWhenDOMLoaded(updateInteractLink)
document.addEventListener('turbolinks:load', updateInteractLink)
</script>


  <!-- Lunr search code - will only be executed on the /search page -->
  <script src="/computational-essay-showroom/assets/js/lunr/lunr.min.js" type="text/javascript"></script>
  <script>var initQuery = function() {
  // See if we have a search box
  var searchInput = document.querySelector('input#lunr_search');
  if (searchInput === null) {
    return;
  }

  // Function to parse our lunr cache
  var idx = lunr(function () {
    this.field('title')
    this.field('excerpt')
    this.field('categories')
    this.field('tags')
    this.ref('id')

    this.pipeline.remove(lunr.trimmer)

    for (var item in store) {
      this.add({
        title: store[item].title,
        excerpt: store[item].excerpt,
        categories: store[item].categories,
        tags: store[item].tags,
        id: item
      })
    }
  });

  // Run search upon keyup
  searchInput.addEventListener('keyup', function () {
    var resultdiv = document.querySelector('#results');
    var query = document.querySelector("input#lunr_search").value.toLowerCase();
    var result =
      idx.query(function (q) {
        query.split(lunr.tokenizer.separator).forEach(function (term) {
          q.term(term, { boost: 100 })
          if(query.lastIndexOf(" ") != query.length-1){
            q.term(term, {  usePipeline: false, wildcard: lunr.Query.wildcard.TRAILING, boost: 10 })
          }
          if (term != ""){
            q.term(term, {  usePipeline: false, editDistance: 1, boost: 1 })
          }
        })
      });

      // Empty the results div
      while (resultdiv.firstChild) {
        resultdiv.removeChild(resultdiv.firstChild);
      }

    resultdiv.insertAdjacentHTML('afterbegin', '<p class="results__found">'+result.length+' Result(s) found</p>');
    for (var item in result) {
      var ref = result[item].ref;
      if(store[ref].teaser){
        var searchitem =
          '<div class="list__item">'+
            '<article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">'+
              '<h2 class="archive__item-title" itemprop="headline">'+
                '<a href="'+store[ref].url+'" rel="permalink">'+store[ref].title+'</a>'+
              '</h2>'+
              '<div class="archive__item-teaser">'+
                '<img src="'+store[ref].teaser+'" alt="">'+
              '</div>'+
              '<p class="archive__item-excerpt" itemprop="description">'+store[ref].excerpt.split(" ").splice(0,20).join(" ")+'...</p>'+
            '</article>'+
          '</div>';
      }
      else{
    	  var searchitem =
          '<div class="list__item">'+
            '<article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">'+
              '<h2 class="archive__item-title" itemprop="headline">'+
                '<a href="'+store[ref].url+'" rel="permalink">'+store[ref].title+'</a>'+
              '</h2>'+
              '<p class="archive__item-excerpt" itemprop="description">'+store[ref].excerpt.split(" ").splice(0,20).join(" ")+'...</p>'+
            '</article>'+
          '</div>';
      }
      resultdiv.insertAdjacentHTML('beforeend', searchitem);
    }
  });
};

initFunction(initQuery);
</script>
</head>

  <body>
    <!-- .js-show-sidebar shows sidebar by default -->
    <div id="js-textbook" class="c-textbook js-show-sidebar">
      



<nav id="js-sidebar" class="c-textbook__sidebar">
  <a href="https://uio-ccse.github.io/computational-essay-showroom"><img src="/computational-essay-showroom/assets/images/uio_logo_small.svg" class="textbook_logo" id="sidebar-logo" data-turbolinks-permanent/></a>
  <h2 class="c-sidebar__title">Computational essays from the University of Oslo</h2>
  <ul class="c-sidebar__chapters">
    
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/computational-essay-showroom/index.html"
        >
          
          Example Essays
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections ">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/computational-essay-showroom/essays/exampleessays/railgun_TOO/Railgun_V1_9.html"
                >
                  
                  How much electric current would you need to use a railgun to launch a package up to the ISS?
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/computational-essay-showroom/essays/exampleessays/iondrives/ExploringTheMartian_V2_5.html"
                >
                  
                  How would ion drives compare to conventional rockets on a trip to Mars?
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/computational-essay-showroom/essays/exampleessays/earthtunnel/earth_tunnel.html"
                >
                  
                  How long would it take to fall through a non-uniform Earth?
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/computational-essay-showroom/index.html"
        >
          
          Student Essays
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections ">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/computational-essay-showroom/essays/studentessays/stormcloud/2D_Stormcloud_Lightning-sisandst_jrevense.html"
                >
                  
                  What is the best material for a lightning rod?
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry c-sidebar__entry--active"
                  href="/computational-essay-showroom/essays/studentessays/LHC/LHC_CompEssay.html"
                >
                  
                  What are the effects of relativity on particles in the LHC?
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/computational-essay-showroom/essays/studentessays/magnetic_bottle_MBP_KG/MagneticBottle_Trap_ComputationalEssay.html"
                >
                  
                  Can we trap a high-energy particle in a magnetic bottle?
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/computational-essay-showroom/essays/studentessays/railgun_FG_IK/Train_Railgun_CompEssay.html"
                >
                  
                  Kan vi bruke en railgun til å akselerere et tog i Oslo t-banen?
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/computational-essay-showroom/essays/studentessays/stormcloud_LS/3D_StormCloud_lassst_FYS1120_H18.html"
                >
                  
                  Hvor langt kan du trygt stå borte fra et lynnedslag?
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
  </ul>
  <p class="sidebar_footer">Powered by <a href="https://github.com/jupyter/jupyter-book">Jupyter Book</a></p>
</nav>

      
      <!-- Shamelessly copied from minimal mistakes -->


<!-- TOC will only show up if it has at least one item -->


  <aside class="sidebar__right">
    <nav class="onthispage">
      <header><h4 class="nav__title"><i class="fa fa-list"></i>   On this page</h4></header>
      <ul class="toc__menu">
  <li><a href="#introduction">Introduction</a></li>
  <li><a href="#developing-the-model">Developing the Model</a></li>
  <li><a href="#simulation-of-the-particle-accelerator">Simulation of the Particle Accelerator</a></li>
  <li><a href="#considering-relativistic-factors">Considering Relativistic Factors</a></li>
  <li><a href="#conclusion">Conclusion</a></li>
</ul>
    </nav>
  </aside>


      
      <main class="c-textbook__page" tabindex="-1">
          <div class="o-wrapper">
            <div class="c-sidebar-toggle">
  <!-- We show the sidebar by default so we use .is-active -->
  <button
    id="js-sidebar-toggle"
    class="hamburger hamburger--arrowalt is-active"
  >
    <span class="hamburger-box">
      <span class="hamburger-inner"></span>
    </span>
    <span class="c-sidebar-toggle__label">Toggle Sidebar</span>
  </button>
</div>

            
<div class="buttons">
<a href="/computational-essay-showroom/content/essays/studentessays/LHC/LHC_CompEssay.ipynb" download>
<button id="interact-button-download" class="interact-button">Download</button>
</a>









<a href="https://mybinder.org/v2/gh/uio-ccse/computational-essay-showroom/master?filepath=content%2Fessays%2Fstudentessays%2FLHC%2FLHC_CompEssay.ipynb"><button class="interact-button" id="interact-button-binder"><img class="interact-button-logo" src="/computational-essay-showroom/assets/images/logo_binder.svg" alt="Interact" />Interact</button></a>


</div>


            <div class="c-textbook__content">
              <h1 id="simulating-cerns-particle-accelerator">Simulating CERNs Particle Accelerator</h1>

<p><strong>A Computational Essay by Erlend Tiberg North and Linn Margrethe Rykkje, University of Oslo</strong></p>

<h2 id="introduction">Introduction</h2>

<p>The code below aims to simulate a version of CERNs accelerator complex, which, in our simplified model, consists of a linear accelerator (LINAC), a proton synchrotron (PS) and the large hadron collider (LHC).
Initially, the provided code concerned a cyclotron; however, since CERNs actual particle accelerator uses a synchrotron, an adaptation descended from the cyclotron, this is the primary focus of the investigation.</p>

<p><strong>Background</strong></p>

<p>Explained simply, the accelerator complex consists of a sequence of machines that cumulatively accelerate particles close to the speed of light. In the case of protons, the protons are retrieved from a bottle of hydrogen gas by using an electric field to strip away their electrons. LINAC 2, the first accelerator in the chain, accelerates the protons to a determined velocity, before sending the beam into a Proton Synchrotron Booster (PBS), followed by the Proton Synchrotron (PS) and then the Super Proton Synchrotron (SPS). When protons exit the SPS, they are injected into two beam pipes of the LHC at a speed of 0.87c. After further acceleration to their maximum kinetic energy, the beams are brought into collision at a speed of 0.99999c!</p>

<p><img src="https://lhc-machine-outreach.web.cern.ch/lhc-machine-outreach/images/complex/Cern-complex.gif" alt="Diagram of the Cern Complex" /></p>

<p><strong>Aim</strong></p>

<p>Our aim is to simulate the particle accelerator; in doing so we have simplified the complex by only including the first LINAC, the PS and the LHC, although the actual system consists of many more components. We attempted to model LINAC2, the PS and the LHC as closely as possible from real values, but also had to make some assumptions. In the end we consider relativistic factors and compare the effects of these to the perfectly ideal situation.</p>

<h2 id="developing-the-model">Developing the Model</h2>

<p><strong>Linear Accelerator 2</strong></p>

<p>The regular LINAC uses an electric field, indirectly defined by a potential difference, $U_0$, and accelerates the proton over a given distance $l$ such that it enters the first PS with a speed of $0.3c$. First we need to know what potential difference must be applied in order to achieve this. Using the relation between electric field, potential and force, we derive the following:</p>

<script type="math/tex; mode=display">F = qE = ma
\\
E = \frac{U_0}{l}
\\
a = \frac{qE}{m} = \frac{qU_0}{lm} 
\\</script>

<p>Then, using motion equations: 
<script type="math/tex">v^2 = v_0 + 2al 
\\
v^2 = 2\frac{qU_0}{lm}l 
\\
U_0 = \frac{1}{2} \frac{mv^2}{q}</script></p>

<p>where $v$ is the desired final speed.</p>

<p>We import the standard libraries and define the input variables for the potential to calculate the initial voltage.</p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span> 

<span class="s">"""Defining variables for LINAC2"""</span>
<span class="n">c</span> <span class="o">=</span> <span class="mf">2.99</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="mi">8</span> <span class="c">#Set the speed of light</span>
<span class="n">q</span> <span class="o">=</span> <span class="mf">1.6e-19</span> <span class="c">#Set the charge of the particle to the charge of a proton</span>
<span class="n">m0</span> <span class="o">=</span> <span class="mf">1.67e-27</span> <span class="c">#Set mass of the particle to the mass of a proton</span>

<span class="n">v0</span> <span class="o">=</span> <span class="mf">0.3</span><span class="o">*</span><span class="n">c</span> <span class="c">#Set wanted exit speed of LINAC2</span>
<span class="n">l0</span> <span class="o">=</span> <span class="mi">500</span> <span class="c">#Set length of LINAC2</span>
<span class="n">U0</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">m0</span><span class="o">*</span><span class="n">v0</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="c">#Set voltage of LINAC2</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Voltage of LINAC2 is: </span><span class="si">%</span><span class="s">e V"</span> <span class="o">%</span> <span class="n">U0</span><span class="p">)</span>
</code></pre></div></div>

<div class="output output_stream highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Voltage of LINAC2 is: 4.199053e+07 V

</code></pre></div></div>

<p><strong>Proton Synchrotron</strong></p>

<p>The PS accelerates the protons whilst also keeping them on a circular path with constant radius, as opposed to the cyclotron where the particles spiral outwards. In our model, the protons are briefly accelerated by a “mini-LINAC” before passing through a set of dipoles. These dipoles are what keep the radius of the motion constant; they direct the beams around the ring by applying a magnetic field proportional to the velocity of the protons. In real life, CERNs PS consists of 100 of such dipoles in addition to 277 conventional electromagnets, distributed over a circumference of 628 meters. Since the conventional electromagnets’ sole purpose is to focus the protons into a fine beam, we decided to not include them in our model. We also assume that the mini-LINAC and dipole appear alternatingly.</p>

<p>Since the protons’ velocity increase in each mini-LINAC, the magnetic field strength must increase proportionately to keep bending the beam the same number of degrees. We thus need a magnetic field strength that varies with the velocity $v$.</p>

<p>For the protons to stay on a circular path, they must have a sentripetal acceleration, which we want the magnetic force to be responsible for; i.e. the magnetic force points radially in towards the center of the PS. The relevant velocity will always be tangential to the circle and thus perpendicular to the magnetic force. If the protons circulate clockwise, the magnetic field we set up must be in the positive $\hat{z}$-direction (out of the plane).</p>

<p>First considering the magnitudes we find that the magnetic field strength must be given by,</p>

<script type="math/tex; mode=display">F = ma = qvB = m\frac{v^2}{r} \\
B = \frac{mv}{qr} \\
\implies \vec{B} = \frac{mv}{qr} \hat{z}</script>

<p>Again, we set the condition that the protons must reach a desired velocity (this time 0.87c) before they are released to the LHC through a proton transfer tube (PTT). This time we choose the potential difference arbitrarily.</p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">"""Defining variables for the PS"""</span>
<span class="n">v1</span> <span class="o">=</span> <span class="mf">0.87</span><span class="o">*</span><span class="n">c</span> <span class="c">#Set wanted exit speed of PS</span>
<span class="n">l1</span> <span class="o">=</span> <span class="mi">3</span> <span class="c">#Set length of MINI-LINACs for the PS</span>
<span class="n">U1</span> <span class="o">=</span> <span class="mf">4.2e4</span> <span class="c">#Set voltage of MINI-LINACs for the PS</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Voltage of PS is: </span><span class="si">%</span><span class="s">e V"</span>  <span class="o">%</span> <span class="n">U1</span><span class="p">)</span>
<span class="n">r1</span> <span class="o">=</span> <span class="mi">1000</span> <span class="c">#Set radius of PS</span>
</code></pre></div></div>

<div class="output output_stream highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Voltage of PS is: 4.200000e+04 V

</code></pre></div></div>

<p><strong>Large Hadron Collider</strong></p>

<p>The LHC is modeled in the same manner as the PS. With a circumference of 27km, it is much larger than the PS and is capable of accelerating the protons to a speed of $0.99999c$. In the LHC, there are two beams of protons that travel in opposite directions so that when the desired speed is reached, the two beams are made to collide at the position of a particle detector.</p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">"""Defining variables for the LHC"""</span>
<span class="n">v2</span> <span class="o">=</span> <span class="n">c</span> <span class="c">#Set wanted speed achieved in the LHC</span>
<span class="n">l2</span> <span class="o">=</span> <span class="mi">3</span> <span class="c">#Set length of MINI-LINACs for the LHC</span>
<span class="n">U2</span> <span class="o">=</span> <span class="mf">2.5e3</span> <span class="c">#Set voltage of MINI-LINACs for the LHC</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Voltage of LHC is: </span><span class="si">%</span><span class="s">e V</span><span class="se">\n</span><span class="s">"</span> <span class="o">%</span> <span class="n">U2</span><span class="p">)</span>
<span class="n">r2</span> <span class="o">=</span> <span class="mi">4250</span> <span class="c">#Set radius of LHC</span>
</code></pre></div></div>

<div class="output output_stream highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Voltage of LHC is: 2.500000e+03 V


</code></pre></div></div>

<h2 id="simulation-of-the-particle-accelerator">Simulation of the Particle Accelerator</h2>

<p>First we set up the needed variables and arrays for the simulation.</p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">"""Initializing simulation"""</span>

<span class="n">t</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">#Initialize time to 0</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">5e-9</span> <span class="c">#Set timestep to 5 nanoseconds</span>

<span class="n">particlepos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">])</span> <span class="c">#Set the initial postition of the particle, starting in LINAC2</span>
<span class="n">particlev</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1e-12</span><span class="p">,</span><span class="mf">1e-12</span><span class="p">,</span><span class="mf">0.0</span><span class="p">])</span> <span class="c">#Set the initial speed of the particle, starting from rest in LINAC2</span>
</code></pre></div></div>

<p>Although the proton is supposed to start from rest in LINAC2, it needs a small initial velocity to avoid computing-error when calculating the norm of the vector in the function for LINAC.</p>

<p>We decided to write functions for the LINAC and PS, as this enables us to more easily call on them with varying input variables. Both functions utilize Euler’s method; first calculating the force acting on the protons (electric in the LINAC and electromagnetic in the PS) and then estimating the acceleration, velocity and position by integrating in time.</p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">"""Function for LINAC"""</span>
<span class="k">def</span> <span class="nf">linac</span><span class="p">(</span><span class="n">U</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">m0</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">pos</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">v1</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">dt</span><span class="p">):</span>

    <span class="n">posx</span> <span class="o">=</span> <span class="p">[</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
    <span class="n">posy</span> <span class="o">=</span> <span class="p">[</span><span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
    <span class="n">speed</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">v</span><span class="p">)]</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">while</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">v1</span><span class="p">):</span>

        <span class="n">Fnet</span> <span class="o">=</span> <span class="p">(</span><span class="n">U</span><span class="o">*</span><span class="n">q</span><span class="p">)</span><span class="o">/</span><span class="n">l</span> <span class="o">*</span> <span class="n">v</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>

        <span class="n">v</span> <span class="o">=</span> <span class="n">v</span> <span class="o">+</span> <span class="n">Fnet</span><span class="o">*</span><span class="n">dt</span><span class="o">/</span><span class="n">m0</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">pos</span> <span class="o">+</span> <span class="n">v</span><span class="o">*</span><span class="n">dt</span>

        <span class="n">posx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">posx</span><span class="p">,</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">posy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">posy</span><span class="p">,</span><span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">speed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">speed</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>

        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">t</span> <span class="o">+=</span> <span class="n">dt</span>

        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">v1</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"Reached </span><span class="si">%.0</span><span class="s">f m"</span> <span class="o">%</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">pos</span><span class="p">))</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"Reached </span><span class="si">%.2</span><span class="s">f</span><span class="si">%% </span><span class="s">of light speed in </span><span class="si">%0</span><span class="s">.f iterations. Time passed: </span><span class="si">%.2</span><span class="s">e seconds"</span> <span class="o">%</span> <span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">/</span><span class="n">c</span><span class="o">*</span><span class="mi">100</span><span class="p">),</span> <span class="n">i</span><span class="p">,</span> <span class="n">t</span><span class="p">))</span>
            <span class="k">break</span>
        <span class="k">elif</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">l</span> <span class="o">-</span> <span class="mf">1E-5</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"Did not reach speed in 50 m"</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"Final speed was </span><span class="si">%.2</span><span class="s">f</span><span class="si">%% </span><span class="s">of light speed in </span><span class="si">%0</span><span class="s">.f iterations. Time passed: </span><span class="si">%.2</span><span class="s">e seconds"</span> <span class="o">%</span> <span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">/</span><span class="n">c</span><span class="o">*</span><span class="mi">100</span><span class="p">),</span> <span class="n">i</span><span class="p">,</span> <span class="n">t</span><span class="p">))</span>
            <span class="k">break</span>
            
    <span class="k">return</span> <span class="n">posx</span><span class="p">,</span> <span class="n">posy</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">speed</span><span class="p">,</span> <span class="n">t</span>
</code></pre></div></div>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">"""Function for a synchrotron"""</span>
<span class="k">def</span> <span class="nf">synchrotron</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">pos</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">v1</span><span class="p">,</span><span class="n">m0</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">clockwise</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">dt</span><span class="p">,</span><span class="n">t0</span><span class="p">):</span>
    <span class="s">"""Simulation of a Synchrotron. Calculates the forces on a particle from a
    mini-LINAC and from a dipole, and integrates its motion by utilizing Euler"""</span>
    <span class="n">posx</span> <span class="o">=</span> <span class="p">[</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
    <span class="n">posy</span> <span class="o">=</span> <span class="p">[</span><span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
    <span class="n">speed</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">v</span><span class="p">)]</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">while</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">v1</span><span class="p">):</span>
        
        <span class="k">if</span> <span class="n">clockwise</span><span class="p">:</span>
            <span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,(</span><span class="n">m0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">v</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">q</span><span class="o">*</span><span class="n">r</span><span class="p">)])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="o">-</span><span class="p">(</span><span class="n">m0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">v</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">q</span><span class="o">*</span><span class="n">r</span><span class="p">)])</span>
        
        <span class="n">Fnet</span> <span class="o">=</span> <span class="p">(</span><span class="n">U</span><span class="o">*</span><span class="n">q</span><span class="p">)</span><span class="o">/</span><span class="n">l</span> <span class="o">*</span> <span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
        <span class="n">Fnet</span> <span class="o">+=</span> <span class="n">q</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>

        <span class="n">v</span> <span class="o">=</span> <span class="n">v</span> <span class="o">+</span> <span class="n">Fnet</span><span class="o">*</span><span class="n">dt</span><span class="o">/</span><span class="n">m0</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">pos</span> <span class="o">+</span> <span class="n">v</span><span class="o">*</span><span class="n">dt</span>

        <span class="n">posx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">posx</span><span class="p">,</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">posy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">posy</span><span class="p">,</span><span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">speed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">speed</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>

        <span class="n">t</span> <span class="o">+=</span> <span class="n">dt</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">100000</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"Did not reach </span><span class="si">%</span><span class="s">.f</span><span class="si">%% </span><span class="s">of light speed within </span><span class="si">%0</span><span class="s">.f iterations"</span> <span class="o">%</span> <span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span><span class="o">/</span><span class="n">c</span><span class="o">*</span><span class="mi">100</span><span class="p">),</span><span class="n">i</span><span class="p">))</span>
            <span class="k">break</span>

    <span class="k">print</span><span class="p">(</span><span class="s">"Reached </span><span class="si">%.2</span><span class="s">f</span><span class="si">%% </span><span class="s">of light speed in </span><span class="si">%.0</span><span class="s">f iterations. Time passed: </span><span class="si">%.2</span><span class="s">e seconds"</span> <span class="o">%</span> <span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">/</span><span class="n">c</span><span class="o">*</span><span class="mi">100</span><span class="p">),</span> <span class="n">i</span><span class="p">,</span> <span class="n">t</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">posx</span><span class="p">,</span> <span class="n">posy</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">speed</span><span class="p">,</span> <span class="n">t</span>
</code></pre></div></div>

<p>Now we can actually make use of everything!</p>

<p>We call on the functions for each component of the particle accelerator and store the returned arrays/lists for plotting purposes.</p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">"""Calling on functions for all components"""</span>

<span class="c">#Linear Accelerator 2</span>
<span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">LINAC2:"</span><span class="p">)</span>
<span class="n">particleposxLINAC2</span><span class="p">,</span> <span class="n">particleposyLINAC2</span><span class="p">,</span> <span class="n">particlepos</span><span class="p">,</span> <span class="n">particlev</span><span class="p">,</span> <span class="n">particlespeedLINAC2</span><span class="p">,</span> <span class="n">t</span>  <span class="o">=</span> <span class="n">linac</span><span class="p">(</span><span class="n">U0</span><span class="p">,</span><span class="n">l0</span><span class="p">,</span><span class="n">m0</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">particlepos</span><span class="p">,</span><span class="n">particlev</span><span class="p">,</span><span class="n">v0</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">dt</span><span class="p">)</span> <span class="c">#Calls the linac function with given variables to simulate CERN's LINAC2</span>
<span class="n">t0</span> <span class="o">=</span> <span class="n">t</span>

<span class="c">#Proton Synchrotron</span>
<span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Proton Synchrotron:"</span><span class="p">)</span>
<span class="n">particleposxPS</span><span class="p">,</span> <span class="n">particleposyPS</span><span class="p">,</span> <span class="n">particlepos</span><span class="p">,</span> <span class="n">particlev</span><span class="p">,</span> <span class="n">particlespeedPS</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">synchrotron</span><span class="p">(</span><span class="n">r1</span><span class="p">,</span><span class="n">l1</span><span class="p">,</span><span class="n">U1</span><span class="p">,</span><span class="n">particlepos</span><span class="p">,</span><span class="n">particlev</span><span class="p">,</span><span class="n">v1</span><span class="p">,</span><span class="n">m0</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="bp">False</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">dt</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="c">#Calls the synchrotron function with given variables to simulate CERN's Proton Synchrotron</span>
<span class="n">t1</span> <span class="o">=</span> <span class="n">t</span>

<span class="c">#Proton Transfer Tube</span>
<span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Proton Transfer Tube:"</span><span class="p">)</span>
<span class="n">particleposxPTT</span> <span class="o">=</span> <span class="p">[</span><span class="n">particlepos</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
<span class="n">particleposyPTT</span> <span class="o">=</span> <span class="p">[</span><span class="n">particlepos</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">500</span><span class="p">):</span>
    <span class="n">particlepos</span> <span class="o">+=</span> <span class="n">particlev</span><span class="o">*</span><span class="n">dt</span> <span class="c">#Integrate the position of a particle using Euler</span>
    <span class="n">particleposxPTT</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">particleposxPTT</span><span class="p">,</span> <span class="n">particlepos</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c">#append the x position to the x-position list</span>
    <span class="n">particleposyPTT</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">particleposyPTT</span><span class="p">,</span> <span class="n">particlepos</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="c">#append the y position to the y-position list</span>
    <span class="n">t</span> <span class="o">+=</span> <span class="n">dt</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Transfered Proton successfully from Proton Synchrotron to Large Hadron Collider"</span><span class="p">)</span>

<span class="c">#Large Hadron Collider</span>
<span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Large Hadron Collider:"</span><span class="p">)</span>
<span class="n">particleposxLHC</span><span class="p">,</span> <span class="n">particleposyLHC</span><span class="p">,</span> <span class="n">particlepos</span><span class="p">,</span> <span class="n">particlev</span><span class="p">,</span> <span class="n">particlespeeedLHC</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">synchrotron</span><span class="p">(</span><span class="n">r2</span><span class="p">,</span><span class="n">l2</span><span class="p">,</span><span class="n">U2</span><span class="p">,</span><span class="n">particlepos</span><span class="p">,</span><span class="n">particlev</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">m0</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="bp">True</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">dt</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

</code></pre></div></div>

<div class="output output_stream highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
LINAC2:
Reached 500 m
Reached 30.00% of light speed in 2230 iterations. Time passed: 1.12e-05 seconds

Proton Synchrotron:
Reached 87.00% of light speed in 25103 iterations. Time passed: 1.37e-04 seconds

Proton Transfer Tube:
Transfered Proton successfully from Proton Synchrotron to Large Hadron Collider

Large Hadron Collider:
Reached 100.00% of light speed in 93793 iterations. Time passed: 6.08e-04 seconds

</code></pre></div></div>

<p>Lastly, we’d like to observe the motion of the protons as they move through the particle accelerator complex. The first code below is a simple 2-dimensional plot showing the x- and y-position of the protons.</p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">"""Regular plot showing motion, non-relativistic"""</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">particleposxLINAC2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">particleposyLINAC2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s">"o"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">"LINAC2 Entry"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">particleposxLINAC2</span><span class="p">,</span> <span class="n">particleposyLINAC2</span><span class="p">,</span> <span class="s">"b"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">"LINAC2 Trajectory"</span><span class="p">)</span> <span class="c">#create the plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">particleposxLINAC2</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">particleposyLINAC2</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s">"o"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">"LINAC2 Exit/PS Entry"</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">particleposxPS</span><span class="p">,</span> <span class="n">particleposyPS</span><span class="p">,</span> <span class="s">"g"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">"PS Trajectory"</span><span class="p">)</span> <span class="c">#create the plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">particleposxPS</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">particleposyPS</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s">"o"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">"PS Exit"</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">particleposxPTT</span><span class="p">,</span> <span class="n">particleposyPTT</span><span class="p">,</span> <span class="s">"r"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">"PTT Trajectory"</span><span class="p">)</span> <span class="c">#create the plot</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">particleposxLHC</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">particleposyLHC</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s">"o"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">"LHC Entry"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">particleposxLHC</span><span class="p">,</span> <span class="n">particleposyLHC</span><span class="p">,</span> <span class="s">"k"</span> <span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">"LHC Trajectory"</span><span class="p">)</span> <span class="c">#create the plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">particleposxLHC</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">particleposyLHC</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s">"oy"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">"End of the Proton's Journey"</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">"x position [m]"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">"y position [m]"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">"Trajectory of a proton in a Particle Accelerator"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s">"equal"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p class="output output_png"><img src="../../../images/essays/studentessays/LHC/LHC_CompEssay_19_0.png" alt="png" /></p>

<h2 id="considering-relativistic-factors">Considering Relativistic Factors</h2>

<p>In the model above, we have neglected the effect of relativistic factors despite the fact that the protons travel at incredibly high speeds. By including the Lorentz factor, $\gamma$, we can see what impact a relativistic increase in mass has on the proton’s motion and velocity. The Lorentz factor is defined as the following:</p>

<script type="math/tex; mode=display">\gamma = \frac{1}{\sqrt{1-\frac{v^2}{c^2}}}</script>

<p>The relativistc mass $m$ is given by the Lorentz factor and the mass at rest, $m_0$:</p>

<script type="math/tex; mode=display">m = \gamma m_0</script>

<p>To implement these changes, we create new simulation variables and arrays, and write a function for the Lorentz factor.</p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">"""Initializing relativistic simulation"""</span>
<span class="n">tr</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">#initialize time to 0 (relativistic)</span>
<span class="n">dtr</span> <span class="o">=</span> <span class="mf">5e-9</span> <span class="c">#Set timestep to 50 nanoseconds (relativistic)</span>

<span class="n">particleposr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">])</span> <span class="c">#Set the initial postition of the particle (relativistic)</span>
<span class="n">particlevr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1e-12</span><span class="p">,</span><span class="mf">1e-12</span><span class="p">,</span><span class="mf">0.0</span><span class="p">])</span> <span class="c">#Set the initial speed of the particle (relativistic)</span>

<span class="k">def</span> <span class="nf">gamma</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
    <span class="s">"""A simple function to return the Lorentz factor for a given velocity"""</span>
    <span class="k">return</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">c</span><span class="o">**</span><span class="mi">2</span><span class="p">)))</span>
</code></pre></div></div>

<p>The core of the functions remain the same, but we want to be able to dictate whether relativistic factors should or should not be included by issuing an if/else-statement.</p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">"""Relativistic function for the LINAC"""</span>

<span class="k">def</span> <span class="nf">linac</span><span class="p">(</span><span class="n">U</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">m0</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">pos</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">v1</span><span class="p">,</span><span class="n">relativistic</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">dt</span><span class="p">,</span><span class="n">t0</span><span class="p">):</span>
    <span class="s">"""Simulates a Linear Accelerator by calculating the net force on
       a particle and integrating its motion with Euler"""</span>
    <span class="n">posx</span> <span class="o">=</span> <span class="p">[</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
    <span class="n">posy</span> <span class="o">=</span> <span class="p">[</span><span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
    <span class="n">speed</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">v</span><span class="p">)]</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">while</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">v1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">relativistic</span><span class="p">:</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">gamma</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">*</span><span class="n">m0</span>
            <span class="k">if</span> <span class="n">t</span><span class="o">==</span><span class="n">t0</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s">"Speed at non-relativistic end-time for </span><span class="si">%</span><span class="s">.f</span><span class="si">%% </span><span class="s">of light speed was </span><span class="si">%.2</span><span class="s">f</span><span class="si">%% </span><span class="s">of light speed"</span> <span class="o">%</span> <span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span><span class="o">/</span><span class="n">c</span><span class="o">*</span><span class="mi">100</span><span class="p">),(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">/</span><span class="n">c</span><span class="o">*</span><span class="mi">100</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">m0</span>
        <span class="n">Fnet</span> <span class="o">=</span> <span class="p">(</span><span class="n">U</span><span class="o">*</span><span class="n">q</span><span class="p">)</span><span class="o">/</span><span class="n">l</span> <span class="o">*</span> <span class="n">v</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>

        <span class="n">v</span> <span class="o">=</span> <span class="n">v</span> <span class="o">+</span> <span class="n">Fnet</span><span class="o">*</span><span class="n">dt</span><span class="o">/</span><span class="n">m</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">pos</span> <span class="o">+</span> <span class="n">v</span><span class="o">*</span><span class="n">dt</span>

        <span class="n">posx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">posx</span><span class="p">,</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">posy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">posy</span><span class="p">,</span><span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">speed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">speed</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>

        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">t</span> <span class="o">+=</span> <span class="n">dt</span>

        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">v1</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"Reached </span><span class="si">%.0</span><span class="s">f m"</span> <span class="o">%</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">pos</span><span class="p">))</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"Reached </span><span class="si">%.2</span><span class="s">f</span><span class="si">%% </span><span class="s">of light speed in </span><span class="si">%0</span><span class="s">.f iterations. Time passed: </span><span class="si">%.2</span><span class="s">e seconds"</span> <span class="o">%</span> <span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">/</span><span class="n">c</span><span class="o">*</span><span class="mi">100</span><span class="p">),</span> <span class="n">i</span><span class="p">,</span> <span class="n">t</span><span class="p">))</span>
            <span class="k">break</span>
        <span class="k">elif</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">l</span> <span class="o">-</span> <span class="mf">1E-5</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"Did not reach speed in 50 m"</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"Final speed was </span><span class="si">%.2</span><span class="s">f</span><span class="si">%% </span><span class="s">of light speed in </span><span class="si">%0</span><span class="s">.f iterations. Time passed: </span><span class="si">%.2</span><span class="s">e seconds"</span> <span class="o">%</span> <span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">/</span><span class="n">c</span><span class="o">*</span><span class="mi">100</span><span class="p">),</span> <span class="n">i</span><span class="p">,</span> <span class="n">t</span><span class="p">))</span>
            <span class="k">break</span>

    <span class="k">return</span> <span class="n">posx</span><span class="p">,</span> <span class="n">posy</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">speed</span><span class="p">,</span> <span class="n">t</span>
</code></pre></div></div>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">"""Relativistic function for a synchrotron"""</span>

<span class="k">def</span> <span class="nf">synchrotron</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">pos</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">v1</span><span class="p">,</span><span class="n">m0</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">clockwise</span><span class="p">,</span><span class="n">relativistic</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">dt</span><span class="p">,</span><span class="n">t0</span><span class="p">):</span>
    <span class="s">"""Simulation of a Synchrotron. Calculates the forces on a particle from a
    mini-LINAC and from a dipole, and integrates its motion by utilizing Euler"""</span>
    <span class="n">posx</span> <span class="o">=</span> <span class="p">[</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
    <span class="n">posy</span> <span class="o">=</span> <span class="p">[</span><span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
    <span class="n">speed</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">v</span><span class="p">)]</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">while</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">v1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">relativistic</span><span class="p">:</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">gamma</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">*</span><span class="n">m0</span>
            <span class="k">if</span> <span class="n">t</span><span class="o">==</span><span class="n">t0</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s">"Speed at non-relativistic end-time for </span><span class="si">%</span><span class="s">.f</span><span class="si">%% </span><span class="s">of light speed was </span><span class="si">%.2</span><span class="s">f</span><span class="si">%% </span><span class="s">of light speed"</span> <span class="o">%</span> <span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span><span class="o">/</span><span class="n">c</span><span class="o">*</span><span class="mi">100</span><span class="p">),(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">/</span><span class="n">c</span><span class="o">*</span><span class="mi">100</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">m0</span>
        <span class="n">Fnet</span> <span class="o">=</span> <span class="p">(</span><span class="n">U</span><span class="o">*</span><span class="n">q</span><span class="p">)</span><span class="o">/</span><span class="n">l</span> <span class="o">*</span> <span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">clockwise</span><span class="p">:</span>
            <span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,(</span><span class="n">m</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">v</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">q</span><span class="o">*</span><span class="n">r</span><span class="p">)])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="o">-</span><span class="p">(</span><span class="n">m</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">v</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">q</span><span class="o">*</span><span class="n">r</span><span class="p">)])</span>

        <span class="n">Fnet</span> <span class="o">+=</span> <span class="n">q</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>

        <span class="n">v</span> <span class="o">=</span> <span class="n">v</span> <span class="o">+</span> <span class="n">Fnet</span><span class="o">*</span><span class="n">dt</span><span class="o">/</span><span class="n">m</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">pos</span> <span class="o">+</span> <span class="n">v</span><span class="o">*</span><span class="n">dt</span>

        <span class="n">posx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">posx</span><span class="p">,</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">posy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">posy</span><span class="p">,</span><span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">speed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">speed</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>

        <span class="n">t</span> <span class="o">+=</span> <span class="n">dt</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">100000</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"Did not reach </span><span class="si">%</span><span class="s">.f</span><span class="si">%% </span><span class="s">of light speed within </span><span class="si">%0</span><span class="s">.f iterations"</span> <span class="o">%</span> <span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span><span class="o">/</span><span class="n">c</span><span class="o">*</span><span class="mi">100</span><span class="p">),</span><span class="n">i</span><span class="p">))</span>
            <span class="k">break</span>

    <span class="k">print</span><span class="p">(</span><span class="s">"Reached </span><span class="si">%.2</span><span class="s">f</span><span class="si">%% </span><span class="s">of light speed in </span><span class="si">%.0</span><span class="s">f iterations. Time passed: </span><span class="si">%.2</span><span class="s">e seconds"</span> <span class="o">%</span> <span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">/</span><span class="n">c</span><span class="o">*</span><span class="mi">100</span><span class="p">),</span> <span class="n">i</span><span class="p">,</span> <span class="n">t</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">posx</span><span class="p">,</span> <span class="n">posy</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">speed</span><span class="p">,</span> <span class="n">t</span>
</code></pre></div></div>

<p>We now call on the functions both with and without relativistic factors. This is because we want to compare the velocity when relativistic factors are included at the time when the protons reach their desired final speed ($0.99999c$) without relativistic factors.</p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">"""Calling on non-relativistic functions"""</span>

<span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n\n</span><span class="s">Non-relativistic"</span><span class="p">)</span>

<span class="c">#Linear Accelerator 2</span>
<span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">LINAC2:"</span><span class="p">)</span>
<span class="n">particleposxLINAC2</span><span class="p">,</span> <span class="n">particleposyLINAC2</span><span class="p">,</span> <span class="n">particlepos</span><span class="p">,</span> <span class="n">particlev</span><span class="p">,</span> <span class="n">particlespeedLINAC2</span><span class="p">,</span> <span class="n">t</span>  <span class="o">=</span> <span class="n">linac</span><span class="p">(</span><span class="n">U0</span><span class="p">,</span><span class="n">l0</span><span class="p">,</span><span class="n">m0</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">particlepos</span><span class="p">,</span><span class="n">particlev</span><span class="p">,</span><span class="n">v0</span><span class="p">,</span><span class="bp">False</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">dt</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="c">#Calls the linac function with given variables to simulate CERN's LINAC2</span>
<span class="n">t0</span> <span class="o">=</span> <span class="n">t</span>

<span class="c">#Proton Synchrotron</span>
<span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Proton Synchrotron:"</span><span class="p">)</span>
<span class="n">particleposxPS</span><span class="p">,</span> <span class="n">particleposyPS</span><span class="p">,</span> <span class="n">particlepos</span><span class="p">,</span> <span class="n">particlev</span><span class="p">,</span> <span class="n">particlespeedPS</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">synchrotron</span><span class="p">(</span><span class="n">r1</span><span class="p">,</span><span class="n">l1</span><span class="p">,</span><span class="n">U1</span><span class="p">,</span><span class="n">particlepos</span><span class="p">,</span><span class="n">particlev</span><span class="p">,</span><span class="n">v1</span><span class="p">,</span><span class="n">m0</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="bp">False</span><span class="p">,</span><span class="bp">False</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">dt</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="c">#Calls the synchrotron function with given variables to simulate CERN's Proton Synchrotron</span>
<span class="n">t1</span> <span class="o">=</span> <span class="n">t</span>

<span class="c">#Proton Transfer Tube</span>
<span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Proton Transfer Tube:"</span><span class="p">)</span>
<span class="n">particleposxPTT</span> <span class="o">=</span> <span class="p">[</span><span class="n">particlepos</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
<span class="n">particleposyPTT</span> <span class="o">=</span> <span class="p">[</span><span class="n">particlepos</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">500</span><span class="p">):</span>
    <span class="n">particlepos</span> <span class="o">+=</span> <span class="n">particlev</span><span class="o">*</span><span class="n">dt</span> <span class="c">#Integrate the position of a particle using Euler</span>
    <span class="n">particleposxPTT</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">particleposxPTT</span><span class="p">,</span> <span class="n">particlepos</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c">#append the x position to the x-position list</span>
    <span class="n">particleposyPTT</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">particleposyPTT</span><span class="p">,</span> <span class="n">particlepos</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="c">#append the y position to the y-position list</span>
    <span class="n">t</span> <span class="o">+=</span> <span class="n">dt</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Transfered Proton successfully from Proton Synchrotron to Large Hadron Collider"</span><span class="p">)</span>

<span class="c">#Large Hadron Collider</span>
<span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Large Hadron Collider:"</span><span class="p">)</span>
<span class="n">particleposxLHC</span><span class="p">,</span> <span class="n">particleposyLHC</span><span class="p">,</span> <span class="n">particlepos</span><span class="p">,</span> <span class="n">particlev</span><span class="p">,</span> <span class="n">particlespeeedLHC</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">synchrotron</span><span class="p">(</span><span class="n">r2</span><span class="p">,</span><span class="n">l2</span><span class="p">,</span><span class="n">U2</span><span class="p">,</span><span class="n">particlepos</span><span class="p">,</span><span class="n">particlev</span><span class="p">,</span><span class="n">v2</span><span class="p">,</span><span class="n">m0</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="bp">True</span><span class="p">,</span><span class="bp">False</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">dt</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="c">#Calls the synchrotorn function with given variables to simulate CERN's Large Hadron Collider</span>
<span class="n">t2</span> <span class="o">=</span> <span class="n">t</span>

<span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Action Report:"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"The final speed of the proton was </span><span class="si">%.2</span><span class="s">f</span><span class="si">%% </span><span class="s">of light speed.  The Lorentz factor was </span><span class="si">%.2</span><span class="s">f"</span> <span class="o">%</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">particlev</span><span class="p">)</span><span class="o">/</span><span class="n">c</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">gamma</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">particlev</span><span class="p">))))</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Time used was </span><span class="si">%</span><span class="s">e seconds "</span> <span class="o">%</span> <span class="n">t</span><span class="p">)</span>

<span class="s">"""Calling on relativistic functions"""</span>

<span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n\n</span><span class="s">Relativistic"</span><span class="p">)</span>

<span class="c">#Linear Accelerator 2</span>
<span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">LINAC2:"</span><span class="p">)</span>
<span class="n">particleposxLINAC2r</span><span class="p">,</span> <span class="n">particleposyLINAC2r</span><span class="p">,</span> <span class="n">particleposr</span><span class="p">,</span> <span class="n">particlevr</span><span class="p">,</span> <span class="n">particlespeedLINAC2r</span><span class="p">,</span> <span class="n">tr</span>  <span class="o">=</span> <span class="n">linac</span><span class="p">(</span><span class="n">U0</span><span class="p">,</span><span class="n">l0</span><span class="p">,</span><span class="n">m0</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">particleposr</span><span class="p">,</span><span class="n">particlevr</span><span class="p">,</span><span class="n">v0</span><span class="p">,</span><span class="bp">True</span><span class="p">,</span><span class="n">tr</span><span class="p">,</span><span class="n">dtr</span><span class="p">,</span><span class="n">t0</span><span class="p">)</span> <span class="c">#Calls the linac function with given variables to simulate CERN's LINAC2 (relativistic)</span>

<span class="c">#Proton Synchrotron</span>
<span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Proton Synchrotron:"</span><span class="p">)</span>
<span class="n">particleposxPSr</span><span class="p">,</span> <span class="n">particleposyPSr</span><span class="p">,</span> <span class="n">particleposr</span><span class="p">,</span> <span class="n">particlevr</span><span class="p">,</span> <span class="n">particlespeedPSr</span><span class="p">,</span> <span class="n">tr</span> <span class="o">=</span> <span class="n">synchrotron</span><span class="p">(</span><span class="n">r1</span><span class="p">,</span><span class="n">l1</span><span class="p">,</span><span class="n">U1</span><span class="p">,</span><span class="n">particleposr</span><span class="p">,</span><span class="n">particlevr</span><span class="p">,</span><span class="n">v1</span><span class="p">,</span><span class="n">m0</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="bp">False</span><span class="p">,</span><span class="bp">True</span><span class="p">,</span><span class="n">tr</span><span class="p">,</span><span class="n">dtr</span><span class="p">,</span><span class="n">t1</span><span class="p">)</span> <span class="c">#Calls the synchrotron function with given variables to simulate CERN's Proton Synchrotron (relativistic)</span>

<span class="c">#Proton Transfer Tube</span>
<span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Proton Transfer Tube:"</span><span class="p">)</span>
<span class="n">particleposxPTTr</span> <span class="o">=</span> <span class="p">[</span><span class="n">particleposr</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
<span class="n">particleposyPTTr</span> <span class="o">=</span> <span class="p">[</span><span class="n">particleposr</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">500</span><span class="p">):</span>
    <span class="n">particleposr</span> <span class="o">+=</span> <span class="n">particlevr</span><span class="o">*</span><span class="n">dtr</span> <span class="c">#Integrate the position of a particle using Euler</span>
    <span class="n">particleposxPTTr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">particleposxPTTr</span><span class="p">,</span> <span class="n">particleposr</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c">#append the x position to the x-position list</span>
    <span class="n">particleposyPTTr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">particleposyPTTr</span><span class="p">,</span> <span class="n">particleposr</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="c">#append the y position to the y-position list</span>
    <span class="n">tr</span> <span class="o">+=</span> <span class="n">dtr</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Transfered Proton successfully from Proton Synchrotron to Large Hadron Collider"</span><span class="p">)</span>

<span class="c">#Large Hadron Collider</span>
<span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Large Hadron Collider:"</span><span class="p">)</span>
<span class="n">particleposxLHCr</span><span class="p">,</span> <span class="n">particleposyLHCr</span><span class="p">,</span> <span class="n">particleposr</span><span class="p">,</span> <span class="n">particlevr</span><span class="p">,</span> <span class="n">particlespeeedLHCr</span><span class="p">,</span> <span class="n">tr</span> <span class="o">=</span> <span class="n">synchrotron</span><span class="p">(</span><span class="n">r2</span><span class="p">,</span><span class="n">l2</span><span class="p">,</span><span class="n">U2</span><span class="p">,</span><span class="n">particleposr</span><span class="p">,</span><span class="n">particlevr</span><span class="p">,</span><span class="n">v2</span><span class="p">,</span><span class="n">m0</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="bp">True</span><span class="p">,</span><span class="bp">True</span><span class="p">,</span><span class="n">tr</span><span class="p">,</span><span class="n">dtr</span><span class="p">,</span><span class="n">t2</span><span class="p">)</span> <span class="c">#Calls the synchrotorn function with given variables to simulate CERN's Large Hadron Collider (relativistic)</span>

<span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Action Report:"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"The final speed of the proton was </span><span class="si">%.2</span><span class="s">f</span><span class="si">%% </span><span class="s">of light speed.  The Lorentz factor was </span><span class="si">%.2</span><span class="s">f"</span> <span class="o">%</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">particlevr</span><span class="p">)</span><span class="o">/</span><span class="n">c</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">gamma</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">particlevr</span><span class="p">))))</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Time used was </span><span class="si">%</span><span class="s">e seconds "</span> <span class="o">%</span> <span class="n">tr</span><span class="p">)</span>
</code></pre></div></div>

<div class="output output_stream highlighter-rouge"><div class="highlight"><pre class="highlight"><code>

Non-relativistic

LINAC2:

Proton Synchrotron:
Reached 100.00% of light speed in 0 iterations. Time passed: 6.08e-04 seconds

Proton Transfer Tube:
Transfered Proton successfully from Proton Synchrotron to Large Hadron Collider

Large Hadron Collider:
Reached 100.00% of light speed in 0 iterations. Time passed: 6.11e-04 seconds

Action Report:
The final speed of the proton was 100.00% of light speed.  The Lorentz factor was nan
Time used was 6.106300e-04 seconds 


Relativistic

LINAC2:
Did not reach speed in 50 m
Final speed was 29.66% of light speed in 2238 iterations. Time passed: 1.12e-05 seconds

Proton Synchrotron:
Reached 87.00% of light speed in 32919 iterations. Time passed: 1.76e-04 seconds

Proton Transfer Tube:
Transfered Proton successfully from Proton Synchrotron to Large Hadron Collider

Large Hadron Collider:
Speed at non-relativistic end-time for 100% of light speed was 92.45% of light speed
Did not reach 100% of light speed within 100000 iterations
Reached 93.18% of light speed in 100000 iterations. Time passed: 6.78e-04 seconds

Action Report:
The final speed of the proton was 93.18% of light speed.  The Lorentz factor was 2.76
Time used was 6.782850e-04 seconds 

</code></pre></div></div>

<p>The resulting motion now changes, as we can also observe in the plot below.</p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">"""Plot showing x and y, relativstic"""</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">particleposxLINAC2r</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">particleposyLINAC2r</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s">"o"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">"LINAC2 Entry"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">particleposxLINAC2r</span><span class="p">,</span> <span class="n">particleposyLINAC2r</span><span class="p">,</span> <span class="s">"b"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">"LINAC2 Trajectory"</span><span class="p">)</span> <span class="c">#create the plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">particleposxLINAC2r</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">particleposyLINAC2r</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s">"o"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">"LINAC2 Exit/PS Entry"</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">particleposxPSr</span><span class="p">,</span> <span class="n">particleposyPSr</span><span class="p">,</span> <span class="s">"g"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">"PS Trajectory"</span><span class="p">)</span> <span class="c">#create the plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">particleposxPSr</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">particleposyPSr</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s">"o"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">"PS Exit"</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">particleposxPTTr</span><span class="p">,</span> <span class="n">particleposyPTTr</span><span class="p">,</span> <span class="s">"r"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">"PTT Trajectory"</span><span class="p">)</span> <span class="c">#create the plot</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">particleposxLHCr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">particleposyLHCr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s">"o"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">"LHC Entry"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">particleposxLHCr</span><span class="p">,</span> <span class="n">particleposyLHCr</span><span class="p">,</span> <span class="s">"k"</span> <span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">"LHC Trajectory"</span><span class="p">)</span> <span class="c">#create the plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">particleposxLHCr</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">particleposyLHCr</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s">"oy"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">"End of the Proton's Journey"</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">"x position [m]"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">"y position [m]"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">"Trajectory of a proton in a Particle Accelerator (relativistic)"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s">"equal"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p class="output output_png"><img src="../../../images/essays/studentessays/LHC/LHC_CompEssay_30_0.png" alt="png" /></p>

<h2 id="conclusion">Conclusion</h2>

<p>We feel that our attempt at creating a (very) simplified model of the particle accelerator was quite successful. Despite lacking many of the actual components, the simulation is able to imitate the workings of the complex to successively accelerate the proton. The implementation of the magnetic field to rotate the path of the protons was perhaps the least accurate one, as we could not find any detailed information regarding the set-up of the dipoles. However, it seems that the protons stay on their circular path while accelerating to the desired end speed, which is what we wanted.</p>

<p>From the investigation we were able to observe the effects of varying the diffrent physical parameters that were sent as input arguments to the accelerators. With voltages as defined in the program above, the protons reach $0.99999c$ in 61 milliseconds when relativistic factors are ignored. However, when taking these into account, the protons are not able to reach the desired end-speed even in the first LINAC and move at 93.18% of the speed of light at the time when non-relativistic protons achieve 99.999%.</p>

<p>The exit position of the protons differs when relativistic factors are included because more time is required to reach the desired exit-velocity. However, it is not realistic that the protons leave its accelerator immediately when this velocity is achieved. An improvement to the model would be to define the exit-position and keep the protons circulating with the final velocity until this positioned was reached. It would then be possible to compare how many rounds in the PS and the HLC were needed when relativistic factors were and were not included.</p>

              <nav class="c-page__nav">
  
    
    <a id="js-page__nav__prev" class="c-page__nav__prev" href="/computational-essay-showroom/essays/studentessays/stormcloud/2D_Stormcloud_Lightning-sisandst_jrevense">
      〈 <span class="u-margin-right-tiny"></span> What is the best material for a li...
    </a>
  

  
    
    <a id="js-page__nav__next" class="c-page__nav__next" href="/computational-essay-showroom/essays/studentessays/magnetic_bottle_MBP_KG/MagneticBottle_Trap_ComputationalEssay">
      Can we trap a high-energy particle... <span class="u-margin-right-tiny"></span> 〉
    </a>
  
</nav>

            </div>
          </div>
        </div>
      </main>
    </div>

  </body>
</html>
